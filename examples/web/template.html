<!doctype html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>l[g]e example</title>
	<style>
		html, body {
			height: 100%;
			margin: 0;
			padding: 0;
			overflow: hidden;
			background: #111;
			width: 100vw;
		}
		body {
			width: 100vw;
			height: 100vh;
			display: flex;
			align-items: stretch;
			justify-content: stretch;
		}
		.emscripten_border, #canvas {
			width: 100vw !important;
			height: 100vh !important;
			background: #111;
			margin: 0;
			padding: 0;
			outline: none;
			display: block;
		}
		/* Hide all other UI elements */
		#spinner, #status, #controls, #progress, #output, a[href="http://emscripten.org"] {
			display: none !important;
		}
	</style>
</head>
<body>
<a href="http://emscripten.org">{{{ SHELL_LOGO }}}</a>
<div class="spinner" id='spinner'></div>
<div class="emscripten" id="status">Downloading...</div>
<span id='controls'>
  <span><input type="checkbox" id="resize">Resize canvas</span>
  <span><input type="checkbox" id="pointerLock" checked>Lock/hide mouse pointer &nbsp;&nbsp;&nbsp;</span>
  <span><input type="button" value="Fullscreen" onclick="Module.requestFullscreen(document.getElementById('pointerLock').checked,
                                                                            document.getElementById('resize').checked)">
  </span>
</span>
<div class="emscripten">
	<progress value="0" max="100" id="progress" hidden=1></progress>
</div>
<div class="emscripten_border">
	<canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()" tabindex=-1></canvas>
</div>
<textarea id="output" rows="8"></textarea>
<script type='text/javascript'>
	// (Unchanged Emscripten shell logic)
	var statusElement = document.getElementById('status');
	var progressElement = document.getElementById('progress');
	var spinnerElement = document.getElementById('spinner');
	var canvasElement = document.getElementById('canvas');
	var outputElement = document.getElementById('output');
	if (outputElement) outputElement.value = '';
	canvasElement.addEventListener('webglcontextlost', (e) => {
		alert('WebGL context lost. You will need to reload the page.');
		e.preventDefault();
	}, false);
	var Module = {
		print(...args) {
			console.log(...args);
			if (outputElement) {
				var text = args.join(' ');
				outputElement.value += text + "\n";
				outputElement.scrollTop = outputElement.scrollHeight;
			}
		},
		canvas: canvasElement,
		setStatus(text) {
			if (!Module.setStatus.last) Module.setStatus.last = { time: Date.now(), text: '' };
			if (text === Module.setStatus.last.text) return;
			var m = text.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/);
			var now = Date.now();
			if (m && now - Module.setStatus.last.time < 30) return;
			Module.setStatus.last.time = now;
			Module.setStatus.last.text = text;
			if (m) {
				text = m[1];
				progressElement.value = parseInt(m[2])*100;
				progressElement.max = parseInt(m[4])*100;
				progressElement.hidden = false;
				spinnerElement.hidden = false;
			} else {
				progressElement.value = null;
				progressElement.max = null;
				progressElement.hidden = true;
				if (!text) spinnerElement.style.display = 'none';
			}
			statusElement.innerHTML = text;
		},
		totalDependencies: 0,
		monitorRunDependencies(left) {
			this.totalDependencies = Math.max(this.totalDependencies, left);
			Module.setStatus(left ? 'Preparing... (' + (this.totalDependencies-left) + '/' + this.totalDependencies + ')' : 'All downloads complete.');
		}
	};
	Module.setStatus('Downloading...');
	window.onerror = (event) => {
		Module.setStatus('Exception thrown, see JavaScript console');
		spinnerElement.style.display = 'none';
		Module.setStatus = (text) => {
			if (text) console.error('[post-exception status] ' + text);
		};
	};
</script>
{{{ SCRIPT }}}
</body>
</html>
